(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-test-paytest-paytest"],{3175:function(t,n,e){var o=e("e54f");"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var r=e("4f06").default;r("bfcd297c",o,!0,{sourceMap:!1,shadowMode:!1})},"5d92":function(t,n,e){"use strict";var o=e("3175"),r=e.n(o);r.a},acb0:function(t,n,e){"use strict";e.r(n);var o=e("e884"),r=e("cecd");for(var i in r)"default"!==i&&function(t){e.d(n,t,(function(){return r[t]}))}(i);e("5d92");var a,u=e("f0c5"),s=Object(u["a"])(r["default"],o["b"],o["c"],!1,null,"579057c6",null,!1,o["a"],a);n["default"]=s.exports},b062:function(t,n,e){"use strict";(function(t){var o=e("ee27");e("99af"),e("a434"),e("d3b7"),Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=o(e("d0ff")),i={data:function(){return{userId:"123456",openid:"",goodsList:[],totalFee:0,status:0,statusText:["未支付","已支付"]}},onLoad:function(n){var e=this,o=n.outTradeNo;this.outTradeNo=o,this.openid=uni.getStorageSync("openid"),uni.showLoading({title:"正在获取商品列表",mask:!0}),t.callFunction({name:"getOrderDetail",data:{outTradeNo:o}}).then((function(t){if(console.log(t),uni.hideLoading(),!(t.result.goodsList&&t.result.goodsList.length>0))throw new Error("获取商品列表失败");var n;(n=e.goodsList).splice.apply(n,[0,0].concat((0,r.default)(t.result.goodsList))),e.totalFee=t.result.totalFee,e.status=t.result.status})).catch((function(t){console.log(t),uni.hideLoading(),uni.showModal({content:t.message||"获取商品列表失败",showCancel:!1})}))},methods:{pay:function(){var n=this,e="";new Promise((function(t,n){uni.getProvider({service:"payment",success:function(n){t(n.provider)},fail:function(){n(new Error("获取支付方式失败"))}})})).then((function(t){return new Promise((function(n,e){uni.showActionSheet({itemList:t,success:function(e){n(t[e.tapIndex])},fail:function(){e(new Error("取消支付"))}})}))})).then((function(o){return e=o,t.callFunction({name:"pay",data:{provider:o,openid:n.openid,outTradeNo:n.outTradeNo}})})).then((function(t){if(console.log(t),t.result.orderInfo)return new Promise((function(n,e){uni.requestPayment({complete:function(){n(t.result.outTradeNo)}})}));throw new Error(t.result.msg)})).then((function(n){return t.callFunction({name:"orderQuery",data:{provider:e,outTradeNo:n}})})).then((function(t){t.result.orderPaid?(n.status=2,uni.showModal({content:"订单已支付",showCancel:!1})):uni.showModal({content:"订单未支付",showCancel:!1})})).catch((function(t){uni.showModal({content:t.message||"登录失败",showCancel:!1})}))}}};n.default=i}).call(this,e("a9ff")["default"])},cecd:function(t,n,e){"use strict";e.r(n);var o=e("b062"),r=e.n(o);for(var i in o)"default"!==i&&function(t){e.d(n,t,(function(){return o[t]}))}(i);n["default"]=r.a},d0ff:function(t,n,e){"use strict";function o(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,o=new Array(n);e<n;e++)o[e]=t[e];return o}function r(t){if(Array.isArray(t))return o(t)}e.r(n);e("a4d3"),e("e01a"),e("d28b"),e("a630"),e("e260"),e("d3b7"),e("3ca3"),e("ddb0");function i(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}e("fb6a"),e("25f0");function a(t,n){if(t){if("string"===typeof t)return o(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(e):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?o(t,n):void 0}}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(t){return r(t)||i(t)||a(t)||u()}e.d(n,"default",(function(){return s}))},e54f:function(t,n,e){var o=e("24fb");n=o(!1),n.push([t.i,".content[data-v-579057c6]{padding:15px}.goods-item[data-v-579057c6],\n.order-info[data-v-579057c6]{padding:10px 0;line-height:30px;font-size:16px}",""]),t.exports=n},e884:function(t,n,e){"use strict";var o,r=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("v-uni-view",{staticClass:"content"},[e("v-uni-view",{staticClass:"list"},t._l(t.goodsList,(function(n,o){return e("v-uni-view",{key:o,staticClass:"goods-item"},[e("v-uni-view",[t._v("商品名："+t._s(n.name))]),e("v-uni-view",[t._v("价格："+t._s(n.price/100)+"元")])],1)})),1),e("v-uni-view",{staticClass:"order-info"},[e("v-uni-view",[e("v-uni-view",[t._v("总金额："+t._s(t.totalFee/100)+"元")]),t.status?e("v-uni-view",[t._v("订单状态："+t._s(t.statusText[t.status-1]))]):t._e()],1)],1),2!==t.status?e("v-uni-button",{attrs:{type:"primary"},on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.pay.apply(void 0,arguments)}}},[t._v("支付")]):t._e()],1)},i=[];e.d(n,"b",(function(){return r})),e.d(n,"c",(function(){return i})),e.d(n,"a",(function(){return o}))}}]);