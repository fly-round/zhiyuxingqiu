(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/public/login"],{"0014":function(e,n,t){"use strict";t.r(n);var a=t("a9e8"),i=t("bda3");for(var o in i)"default"!==o&&function(e){t.d(n,e,(function(){return i[e]}))}(o);t("78c3");var r,c=t("f0c5"),u=Object(c["a"])(i["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],r);n["default"]=u.exports},"321d":function(e,n,t){},"78c3":function(e,n,t){"use strict";var a=t("321d"),i=t.n(a);i.a},a9e8:function(e,n,t){"use strict";var a,i=function(){var e=this,n=e.$createElement;e._self._c},o=[];t.d(n,"b",(function(){return i})),t.d(n,"c",(function(){return o})),t.d(n,"a",(function(){return a}))},bda3:function(e,n,t){"use strict";t.r(n);var a=t("e5b4"),i=t.n(a);for(var o in a)"default"!==o&&function(e){t.d(n,e,(function(){return a[e]}))}(o);n["default"]=i.a},e5b4:function(e,n,t){"use strict";(function(e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=o(t("4795")),i=t("2f62");function o(e){return e&&e.__esModule?e:{default:e}}function r(e,n,t,a,i,o,r){try{var c=e[o](r),u=c.value}catch(s){return void t(s)}c.done?n(u):Promise.resolve(u).then(a,i)}function c(e){return function(){var n=this,t=arguments;return new Promise((function(a,i){var o=e.apply(n,t);function c(e){r(o,a,i,c,u,"next",e)}function u(e){r(o,a,i,c,u,"throw",e)}c(void 0)}))}}function u(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?u(Object(t),!0).forEach((function(n){f(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):u(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function f(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var d={data:function(){return{loginType:"",phone:"",password:"",logining:!1}},onShow:function(){this.$api.logout()},onLoad:function(e){},methods:s({},(0,i.mapMutations)(["login"]),{inputChange:function(e){var n=e.currentTarget.dataset.key;this[n]=e.detail.value},chooseLoginType:function(e){this.loginType=e},navBack:function(){e.navigateBack()},toRegist:function(){e.redirectTo({url:"/pages/public/register"})},toLogin:function(){var n=this;return c(a.default.mark((function t(){var i;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:i=n,11!==i.phone.length?i.$api.msg("请输入11位中国手机号"):i.password.length<8?i.$api.msg("密码至少8位"):(i.logining=!0,e.login({provider:"weixin",success:function(n){i.$api.request("user","login",{phone:i.phone,password:i.password,loginType:1,raw:JSON.stringify(n)},(function(n){i.logining=!1,e.showToast({title:n.errmsg,icon:"none"})})).then((function(n){i.logining=!1,i.$store.commit("login",n.data),e.setStorageSync("userInfo",n.data),i.$api.prePage().lodaData&&i.$api.prePage().loadData(),e.navigateBack()}))}}));case 2:case"end":return t.stop()}}),t)})))()},miniWechatLogin:function(n){var t=this;t.logining=!0;var a=1,i=n.detail.userInfo;e.login({provider:"weixin",success:function(n){t.logining=!1,t.$api.request("user","thirdPartLogin",{loginType:a,raw:JSON.stringify(n)},(function(n){t.$api.msg(n.errmsg),e.hideLoading()})).then((function(n){t.$api.setUserInfo(n.data),t.$api.request("user","syncUserInfo",i).then((function(a){n.data.nickname=i.nickName,n.data.avatarUrl=i.avatarUrl,n.data.gender=i.gender,e.setStorageSync("userInfo",n.data),t.$store.commit("login",n.data),t.$api.setUserInfo(n.data),t.$api.prePage().lodaData&&t.$api.prePage().loadData(),e.hideLoading(),e.navigateBack()}))}))}})},wechatLogin:function(){var n=this;n.logining=!0;var t=2;e.showLoading({title:"正在同步消息"}),e.login({provider:"weixin",success:function(a){n.$api.request("user","thirdPartLogin",{loginType:t,raw:JSON.stringify(a)},(function(t){n.$api.msg(t.errmsg),e.hideLoading()})).then((function(t){n.logining=!1,e.getUserInfo({lang:"zh_CN",success:function(a){e.setStorageSync("userInfo",t.data),n.$store.commit("login",t.data),a.userInfo.nickname=a.userInfo.nickName,n.$api.request("user","syncUserInfo",a.userInfo).then((function(i){t.data.nickname=a.userInfo.nickName,t.data.avatarUrl=a.userInfo.avatarUrl,t.data.gender=a.userInfo.gender,e.setStorageSync("userInfo",t.data),n.$store.commit("login",t.data)}))},complete:function(t){n.$api.prePage().lodaData&&n.$api.prePage().loadData(),e.hideLoading(),e.navigateBack()}})}))}})},wechatH5Login:function(){var e=this,n=window.location.origin,t=e.$api.prePage(),a="/pages/index/index";t&&(a=t.__page__.path),window.location="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+e.$api.defConfig().h5Appid+"&redirect_uri="+escape(n)+"&response_type=code&scope=snsapi_userinfo&state="+escape(a)+"#wechat_redirect"}})};n.default=d}).call(this,t("543d")["default"])},f053:function(e,n,t){"use strict";(function(e){t("435e"),t("921b");a(t("66fd"));var n=a(t("0014"));function a(e){return e&&e.__esModule?e:{default:e}}e(n.default)}).call(this,t("543d")["createPage"])}},[["f053","common/runtime","common/vendor"]]]);